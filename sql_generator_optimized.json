{
  "generate.predict": {
    "traces": [],
    "train": [],
    "demos": [
      {
        "augmented": true,
        "question": "Top 3 products by total revenue all-time.",
        "schema": "CREATE TABLE [Categories]\n(      [CategoryID] INTEGER PRIMARY KEY AUTOINCREMENT,\n       [CategoryName] TEXT,\n       [Description] TEXT,\n       [Picture] BLOB\n)\n\nCREATE TABLE [Customers]\n(      [CustomerID] TEXT,\n       [CompanyName] TEXT,\n       [ContactName] TEXT,\n       [ContactTitle] TEXT,\n       [Address] TEXT,\n       [City] TEXT,\n       [Region] TEXT,\n       [PostalCode] TEXT,\n       [Country] TEXT,\n       [Phone] TEXT,\n       [Fax] TEXT,\n       PRIMARY KEY (`CustomerID`)\n)\n\nCREATE TABLE [Order Details](\n   [OrderID]INTEGER NOT NULL,\n   [ProductID]INTEGER NOT NULL,\n   [UnitPrice]NUMERIC NOT NULL DEFAULT 0,\n   [Quantity]INTEGER NOT NULL DEFAULT 1,\n   [Discount]REAL NOT NULL DEFAULT 0,\n    PRIMARY KEY (\"OrderID\",\"ProductID\"),\n    CHECK ([Discount]>=(0) AND [Discount]<=(1)),\n    CHECK ([Quantity]>(0)),\n    CHECK ([UnitPrice]>=(0)),\n\tFOREIGN KEY ([OrderID]) REFERENCES [Orders] ([OrderID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ProductID]) REFERENCES [Products] ([ProductID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Orders](\n   [OrderID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CustomerID]TEXT,\n   [EmployeeID]INTEGER,\n   [OrderDate]DATETIME,\n   [RequiredDate]DATETIME,\n   [ShippedDate]DATETIME,\n   [ShipVia]INTEGER,\n   [Freight]NUMERIC DEFAULT 0,\n   [ShipName]TEXT,\n   [ShipAddress]TEXT,\n   [ShipCity]TEXT,\n   [ShipRegion]TEXT,\n   [ShipPostalCode]TEXT,\n   [ShipCountry]TEXT,\n   FOREIGN KEY ([EmployeeID]) REFERENCES [Employees] ([EmployeeID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([CustomerID]) REFERENCES [Customers] ([CustomerID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ShipVia]) REFERENCES [Shippers] ([ShipperID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Products](\n   [ProductID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [ProductName]TEXT NOT NULL,\n   [SupplierID]INTEGER,\n   [CategoryID]INTEGER,\n   [QuantityPerUnit]TEXT,\n   [UnitPrice]NUMERIC DEFAULT 0,\n   [UnitsInStock]INTEGER DEFAULT 0,\n   [UnitsOnOrder]INTEGER DEFAULT 0,\n   [ReorderLevel]INTEGER DEFAULT 0,\n   [Discontinued]TEXT NOT NULL DEFAULT '0',\n    CHECK ([UnitPrice]>=(0)),\n    CHECK ([ReorderLevel]>=(0)),\n    CHECK ([UnitsInStock]>=(0)),\n    CHECK ([UnitsOnOrder]>=(0)),\n\tFOREIGN KEY ([CategoryID]) REFERENCES [Categories] ([CategoryID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([SupplierID]) REFERENCES [Suppliers] ([SupplierID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Suppliers](\n   [SupplierID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CompanyName]TEXT NOT NULL,\n   [ContactName]TEXT,\n   [ContactTitle]TEXT,\n   [Address]TEXT,\n   [City]TEXT,\n   [Region]TEXT,\n   [PostalCode]TEXT,\n   [Country]TEXT,\n   [Phone]TEXT,\n   [Fax]TEXT,\n   [HomePage]TEXT\n)",
        "reasoning": "]\nTo find the top 3 products by total revenue all-time, we need to calculate the total revenue for each product. The total revenue is calculated as the product of `UnitPrice` and `Quantity` minus any applicable `Discount`. We will sum this value for each product across all orders.\n\nSteps:\n1. Calculate the revenue for each order detail: `(UnitPrice * Quantity) - (UnitPrice * Quantity * Discount)`.\n2. Group by ProductID to get total revenue per product.\n3. Sort the results in descending order of total revenue.\n4. Limit the results to the top 3 products.",
        "sql_query": "SELECT \"Products\".\"ProductName\",\n       SUM((\"Order Details\".\"UnitPrice\" * \"Order Details\".\"Quantity\") - (\"Order Details\".\"UnitPrice\" * \"Order Details\".\"Quantity\" * \"Order Details\".\"Discount\")) AS TotalRevenue\nFROM \"Order Details\"\nJOIN \"Products\" ON \"Order Details\".\"ProductID\" = \"Products\".\"ProductID\"\nGROUP BY \"Products\".\"ProductName\"\nORDER BY TotalRevenue DESC\nLIMIT 3;"
      },
      {
        "augmented": true,
        "question": "During 'Summer Beverages 1997' as defined in the marketing calendar, which product category had the highest total quantity sold?",
        "schema": "CREATE TABLE [Categories]\n(      [CategoryID] INTEGER PRIMARY KEY AUTOINCREMENT,\n       [CategoryName] TEXT,\n       [Description] TEXT,\n       [Picture] BLOB\n)\n\nCREATE TABLE [Customers]\n(      [CustomerID] TEXT,\n       [CompanyName] TEXT,\n       [ContactName] TEXT,\n       [ContactTitle] TEXT,\n       [Address] TEXT,\n       [City] TEXT,\n       [Region] TEXT,\n       [PostalCode] TEXT,\n       [Country] TEXT,\n       [Phone] TEXT,\n       [Fax] TEXT,\n       PRIMARY KEY (`CustomerID`)\n)\n\nCREATE TABLE [Order Details](\n   [OrderID]INTEGER NOT NULL,\n   [ProductID]INTEGER NOT NULL,\n   [UnitPrice]NUMERIC NOT NULL DEFAULT 0,\n   [Quantity]INTEGER NOT NULL DEFAULT 1,\n   [Discount]REAL NOT NULL DEFAULT 0,\n    PRIMARY KEY (\"OrderID\",\"ProductID\"),\n    CHECK ([Discount]>=(0) AND [Discount]<=(1)),\n    CHECK ([Quantity]>(0)),\n    CHECK ([UnitPrice]>=(0)),\n\tFOREIGN KEY ([OrderID]) REFERENCES [Orders] ([OrderID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ProductID]) REFERENCES [Products] ([ProductID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Orders](\n   [OrderID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CustomerID]TEXT,\n   [EmployeeID]INTEGER,\n   [OrderDate]DATETIME,\n   [RequiredDate]DATETIME,\n   [ShippedDate]DATETIME,\n   [ShipVia]INTEGER,\n   [Freight]NUMERIC DEFAULT 0,\n   [ShipName]TEXT,\n   [ShipAddress]TEXT,\n   [ShipCity]TEXT,\n   [ShipRegion]TEXT,\n   [ShipPostalCode]TEXT,\n   [ShipCountry]TEXT,\n   FOREIGN KEY ([EmployeeID]) REFERENCES [Employees] ([EmployeeID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([CustomerID]) REFERENCES [Customers] ([CustomerID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ShipVia]) REFERENCES [Shippers] ([ShipperID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Products](\n   [ProductID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [ProductName]TEXT NOT NULL,\n   [SupplierID]INTEGER,\n   [CategoryID]INTEGER,\n   [QuantityPerUnit]TEXT,\n   [UnitPrice]NUMERIC DEFAULT 0,\n   [UnitsInStock]INTEGER DEFAULT 0,\n   [UnitsOnOrder]INTEGER DEFAULT 0,\n   [ReorderLevel]INTEGER DEFAULT 0,\n   [Discontinued]TEXT NOT NULL DEFAULT '0',\n    CHECK ([UnitPrice]>=(0)),\n    CHECK ([ReorderLevel]>=(0)),\n    CHECK ([UnitsInStock]>=(0)),\n    CHECK ([UnitsOnOrder]>=(0)),\n\tFOREIGN KEY ([CategoryID]) REFERENCES [Categories] ([CategoryID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([SupplierID]) REFERENCES [Suppliers] ([SupplierID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Suppliers](\n   [SupplierID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CompanyName]TEXT NOT NULL,\n   [ContactName]TEXT,\n   [ContactTitle]TEXT,\n   [Address]TEXT,\n   [City]TEXT,\n   [Region]TEXT,\n   [PostalCode]TEXT,\n   [Country]TEXT,\n   [Phone]TEXT,\n   [Fax]TEXT,\n   [HomePage]TEXT\n)",
        "reasoning": "]\nTo solve this problem, we need to identify which product category had the highest total quantity sold during 'Summer Beverages 1997'. This will involve joining multiple tables and summing up quantities based on category IDs.\n\nHere's the step-by-step approach:\n- We'll start by identifying orders that fall within the 'Summer Beverages 1997' period, which typically corresponds to a specific timeframe such as June to August of 1997.\n- Using this subset of orders, we'll aggregate sales data by product category.\n- Finally, we will calculate and find out the highest quantity sold for each category within this time frame.\n\nThe main tables involved are `Orders`, `Order Details`, and `Products` along with their associated foreign key relationships to `Categories`.",
        "sql_query": "SELECT\n    c.CategoryName AS Product_Category,\n    SUM(od.Quantity) AS Total_Quantity_Sold\nFROM Orders o\nJOIN \"Order Details\" od ON o.OrderID = od.OrderID\nJOIN Products p ON od.ProductID = p.ProductID\nJOIN Categories c ON p.CategoryID = c.CategoryID\nWHERE STRFTIME('%Y', o.OrderDate) = '1997'\n  AND (STRFTIME('%m-%d', o.OrderDate) BETWEEN '06-01' AND '08-31')\nGROUP BY c.CategoryName\nORDER BY Total_Quantity_Sold DESC\nLIMIT 1;"
      },
      {
        "augmented": true,
        "question": "Top 3 products by total revenue all-time.",
        "schema": "CREATE TABLE [Categories]\n(      [CategoryID] INTEGER PRIMARY KEY AUTOINCREMENT,\n       [CategoryName] TEXT,\n       [Description] TEXT,\n       [Picture] BLOB\n)\n\nCREATE TABLE [Customers]\n(      [CustomerID] TEXT,\n       [CompanyName] TEXT,\n       [ContactName] TEXT,\n       [ContactTitle] TEXT,\n       [Address] TEXT,\n       [City] TEXT,\n       [Region] TEXT,\n       [PostalCode] TEXT,\n       [Country] TEXT,\n       [Phone] TEXT,\n       [Fax] TEXT,\n       PRIMARY KEY (`CustomerID`)\n)\n\nCREATE TABLE [Order Details](\n   [OrderID]INTEGER NOT NULL,\n   [ProductID]INTEGER NOT NULL,\n   [UnitPrice]NUMERIC NOT NULL DEFAULT 0,\n   [Quantity]INTEGER NOT NULL DEFAULT 1,\n   [Discount]REAL NOT NULL DEFAULT 0,\n    PRIMARY KEY (\"OrderID\",\"ProductID\"),\n    CHECK ([Discount]>=(0) AND [Discount]<=(1)),\n    CHECK ([Quantity]>(0)),\n    CHECK ([UnitPrice]>=(0)),\n\tFOREIGN KEY ([OrderID]) REFERENCES [Orders] ([OrderID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ProductID]) REFERENCES [Products] ([ProductID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Orders](\n   [OrderID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CustomerID]TEXT,\n   [EmployeeID]INTEGER,\n   [OrderDate]DATETIME,\n   [RequiredDate]DATETIME,\n   [ShippedDate]DATETIME,\n   [ShipVia]INTEGER,\n   [Freight]NUMERIC DEFAULT 0,\n   [ShipName]TEXT,\n   [ShipAddress]TEXT,\n   [ShipCity]TEXT,\n   [ShipRegion]TEXT,\n   [ShipPostalCode]TEXT,\n   [ShipCountry]TEXT,\n   FOREIGN KEY ([EmployeeID]) REFERENCES [Employees] ([EmployeeID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([CustomerID]) REFERENCES [Customers] ([CustomerID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ShipVia]) REFERENCES [Shippers] ([ShipperID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Products](\n   [ProductID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [ProductName]TEXT NOT NULL,\n   [SupplierID]INTEGER,\n   [CategoryID]INTEGER,\n   [QuantityPerUnit]TEXT,\n   [UnitPrice]NUMERIC DEFAULT 0,\n   [UnitsInStock]INTEGER DEFAULT 0,\n   [UnitsOnOrder]INTEGER DEFAULT 0,\n   [ReorderLevel]INTEGER DEFAULT 0,\n   [Discontinued]TEXT NOT NULL DEFAULT '0',\n    CHECK ([UnitPrice]>=(0)),\n    CHECK ([ReorderLevel]>=(0)),\n    CHECK ([UnitsInStock]>=(0)),\n    CHECK ([UnitsOnOrder]>=(0)),\n\tFOREIGN KEY ([CategoryID]) REFERENCES [Categories] ([CategoryID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([SupplierID]) REFERENCES [Suppliers] ([SupplierID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Suppliers](\n   [SupplierID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CompanyName]TEXT NOT NULL,\n   [ContactName]TEXT,\n   [ContactTitle]TEXT,\n   [Address]TEXT,\n   [City]TEXT,\n   [Region]TEXT,\n   [PostalCode]TEXT,\n   [Country]TEXT,\n   [Phone]TEXT,\n   [Fax]TEXT,\n   [HomePage]TEXT\n)",
        "reasoning": "]\nTo find the top 3 products by total revenue all-time, we need to calculate the total revenue for each product. The total revenue is calculated as the product of `UnitPrice` and `Quantity` minus any applicable `Discount`. We will sum this value for each product across all orders.\n\nSteps:\n1. Calculate the revenue for each order detail: `(UnitPrice * Quantity) - (UnitPrice * Quantity * Discount)`.\n2. Group by ProductID to get total revenue per product.\n3. Sort the results in descending order of total revenue.\n4. Limit the results to the top 3 products.",
        "sql_query": "SELECT \"Products\".\"ProductName\",\n       SUM((\"Order Details\".\"UnitPrice\" * \"Order Details\".\"Quantity\") - (\"Order Details\".\"UnitPrice\" * \"Order Details\".\"Quantity\" * \"Order Details\".\"Discount\")) AS TotalRevenue\nFROM \"Order Details\"\nJOIN \"Products\" ON \"Order Details\".\"ProductID\" = \"Products\".\"ProductID\"\nGROUP BY \"Products\".\"ProductName\"\nORDER BY TotalRevenue DESC\nLIMIT 3;"
      },
      {
        "question": "Per the KPI definition of gross margin, who was the top customer by gross margin in 1997? Assume CostOfGoods is approximated by 70% of UnitPrice if not available.",
        "schema": "CREATE TABLE [Categories]\n(      [CategoryID] INTEGER PRIMARY KEY AUTOINCREMENT,\n       [CategoryName] TEXT,\n       [Description] TEXT,\n       [Picture] BLOB\n)\n\nCREATE TABLE [Customers]\n(      [CustomerID] TEXT,\n       [CompanyName] TEXT,\n       [ContactName] TEXT,\n       [ContactTitle] TEXT,\n       [Address] TEXT,\n       [City] TEXT,\n       [Region] TEXT,\n       [PostalCode] TEXT,\n       [Country] TEXT,\n       [Phone] TEXT,\n       [Fax] TEXT,\n       PRIMARY KEY (`CustomerID`)\n)\n\nCREATE TABLE [Order Details](\n   [OrderID]INTEGER NOT NULL,\n   [ProductID]INTEGER NOT NULL,\n   [UnitPrice]NUMERIC NOT NULL DEFAULT 0,\n   [Quantity]INTEGER NOT NULL DEFAULT 1,\n   [Discount]REAL NOT NULL DEFAULT 0,\n    PRIMARY KEY (\"OrderID\",\"ProductID\"),\n    CHECK ([Discount]>=(0) AND [Discount]<=(1)),\n    CHECK ([Quantity]>(0)),\n    CHECK ([UnitPrice]>=(0)),\n\tFOREIGN KEY ([OrderID]) REFERENCES [Orders] ([OrderID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ProductID]) REFERENCES [Products] ([ProductID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Orders](\n   [OrderID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CustomerID]TEXT,\n   [EmployeeID]INTEGER,\n   [OrderDate]DATETIME,\n   [RequiredDate]DATETIME,\n   [ShippedDate]DATETIME,\n   [ShipVia]INTEGER,\n   [Freight]NUMERIC DEFAULT 0,\n   [ShipName]TEXT,\n   [ShipAddress]TEXT,\n   [ShipCity]TEXT,\n   [ShipRegion]TEXT,\n   [ShipPostalCode]TEXT,\n   [ShipCountry]TEXT,\n   FOREIGN KEY ([EmployeeID]) REFERENCES [Employees] ([EmployeeID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([CustomerID]) REFERENCES [Customers] ([CustomerID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ShipVia]) REFERENCES [Shippers] ([ShipperID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Products](\n   [ProductID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [ProductName]TEXT NOT NULL,\n   [SupplierID]INTEGER,\n   [CategoryID]INTEGER,\n   [QuantityPerUnit]TEXT,\n   [UnitPrice]NUMERIC DEFAULT 0,\n   [UnitsInStock]INTEGER DEFAULT 0,\n   [UnitsOnOrder]INTEGER DEFAULT 0,\n   [ReorderLevel]INTEGER DEFAULT 0,\n   [Discontinued]TEXT NOT NULL DEFAULT '0',\n    CHECK ([UnitPrice]>=(0)),\n    CHECK ([ReorderLevel]>=(0)),\n    CHECK ([UnitsInStock]>=(0)),\n    CHECK ([UnitsOnOrder]>=(0)),\n\tFOREIGN KEY ([CategoryID]) REFERENCES [Categories] ([CategoryID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([SupplierID]) REFERENCES [Suppliers] ([SupplierID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Suppliers](\n   [SupplierID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CompanyName]TEXT NOT NULL,\n   [ContactName]TEXT,\n   [ContactTitle]TEXT,\n   [Address]TEXT,\n   [City]TEXT,\n   [Region]TEXT,\n   [PostalCode]TEXT,\n   [Country]TEXT,\n   [Phone]TEXT,\n   [Fax]TEXT,\n   [HomePage]TEXT\n)",
        "query": "SELECT T3.CompanyName, SUM(T2.Quantity * (T2.UnitPrice * 0.3) * (1 - T2.Discount)) AS GrossMargin FROM Orders AS T1 INNER JOIN 'Order Details' AS T2 ON T1.OrderID = T2.OrderID INNER JOIN Customers AS T3 ON T1.CustomerID = T3.CustomerID WHERE STRFTIME('%Y', T1.OrderDate) = '1997' GROUP BY T3.CompanyName ORDER BY GrossMargin DESC LIMIT 1;"
      },
      {
        "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates.",
        "schema": "CREATE TABLE [Categories]\n(      [CategoryID] INTEGER PRIMARY KEY AUTOINCREMENT,\n       [CategoryName] TEXT,\n       [Description] TEXT,\n       [Picture] BLOB\n)\n\nCREATE TABLE [Customers]\n(      [CustomerID] TEXT,\n       [CompanyName] TEXT,\n       [ContactName] TEXT,\n       [ContactTitle] TEXT,\n       [Address] TEXT,\n       [City] TEXT,\n       [Region] TEXT,\n       [PostalCode] TEXT,\n       [Country] TEXT,\n       [Phone] TEXT,\n       [Fax] TEXT,\n       PRIMARY KEY (`CustomerID`)\n)\n\nCREATE TABLE [Order Details](\n   [OrderID]INTEGER NOT NULL,\n   [ProductID]INTEGER NOT NULL,\n   [UnitPrice]NUMERIC NOT NULL DEFAULT 0,\n   [Quantity]INTEGER NOT NULL DEFAULT 1,\n   [Discount]REAL NOT NULL DEFAULT 0,\n    PRIMARY KEY (\"OrderID\",\"ProductID\"),\n    CHECK ([Discount]>=(0) AND [Discount]<=(1)),\n    CHECK ([Quantity]>(0)),\n    CHECK ([UnitPrice]>=(0)),\n\tFOREIGN KEY ([OrderID]) REFERENCES [Orders] ([OrderID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ProductID]) REFERENCES [Products] ([ProductID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Orders](\n   [OrderID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CustomerID]TEXT,\n   [EmployeeID]INTEGER,\n   [OrderDate]DATETIME,\n   [RequiredDate]DATETIME,\n   [ShippedDate]DATETIME,\n   [ShipVia]INTEGER,\n   [Freight]NUMERIC DEFAULT 0,\n   [ShipName]TEXT,\n   [ShipAddress]TEXT,\n   [ShipCity]TEXT,\n   [ShipRegion]TEXT,\n   [ShipPostalCode]TEXT,\n   [ShipCountry]TEXT,\n   FOREIGN KEY ([EmployeeID]) REFERENCES [Employees] ([EmployeeID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([CustomerID]) REFERENCES [Customers] ([CustomerID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ShipVia]) REFERENCES [Shippers] ([ShipperID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Products](\n   [ProductID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [ProductName]TEXT NOT NULL,\n   [SupplierID]INTEGER,\n   [CategoryID]INTEGER,\n   [QuantityPerUnit]TEXT,\n   [UnitPrice]NUMERIC DEFAULT 0,\n   [UnitsInStock]INTEGER DEFAULT 0,\n   [UnitsOnOrder]INTEGER DEFAULT 0,\n   [ReorderLevel]INTEGER DEFAULT 0,\n   [Discontinued]TEXT NOT NULL DEFAULT '0',\n    CHECK ([UnitPrice]>=(0)),\n    CHECK ([ReorderLevel]>=(0)),\n    CHECK ([UnitsInStock]>=(0)),\n    CHECK ([UnitsOnOrder]>=(0)),\n\tFOREIGN KEY ([CategoryID]) REFERENCES [Categories] ([CategoryID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([SupplierID]) REFERENCES [Suppliers] ([SupplierID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Suppliers](\n   [SupplierID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CompanyName]TEXT NOT NULL,\n   [ContactName]TEXT,\n   [ContactTitle]TEXT,\n   [Address]TEXT,\n   [City]TEXT,\n   [Region]TEXT,\n   [PostalCode]TEXT,\n   [Country]TEXT,\n   [Phone]TEXT,\n   [Fax]TEXT,\n   [HomePage]TEXT\n)",
        "query": "SELECT SUM(T2.UnitPrice * T2.Quantity * (1 - T2.Discount)) FROM Orders AS T1 INNER JOIN 'Order Details' AS T2 ON T1.OrderID = T2.OrderID INNER JOIN Products AS T3 ON T2.ProductID = T3.ProductID INNER JOIN Categories AS T4 ON T3.CategoryID = T4.CategoryID WHERE T1.OrderDate BETWEEN '1997-06-01' AND '1997-06-30' AND T4.CategoryName = 'Beverages';"
      },
      {
        "question": "Total revenue from the 'Beverages' category during 'Summer Beverages 1997' dates.",
        "schema": "CREATE TABLE [Categories]\n(      [CategoryID] INTEGER PRIMARY KEY AUTOINCREMENT,\n       [CategoryName] TEXT,\n       [Description] TEXT,\n       [Picture] BLOB\n)\n\nCREATE TABLE [Customers]\n(      [CustomerID] TEXT,\n       [CompanyName] TEXT,\n       [ContactName] TEXT,\n       [ContactTitle] TEXT,\n       [Address] TEXT,\n       [City] TEXT,\n       [Region] TEXT,\n       [PostalCode] TEXT,\n       [Country] TEXT,\n       [Phone] TEXT,\n       [Fax] TEXT,\n       PRIMARY KEY (`CustomerID`)\n)\n\nCREATE TABLE [Order Details](\n   [OrderID]INTEGER NOT NULL,\n   [ProductID]INTEGER NOT NULL,\n   [UnitPrice]NUMERIC NOT NULL DEFAULT 0,\n   [Quantity]INTEGER NOT NULL DEFAULT 1,\n   [Discount]REAL NOT NULL DEFAULT 0,\n    PRIMARY KEY (\"OrderID\",\"ProductID\"),\n    CHECK ([Discount]>=(0) AND [Discount]<=(1)),\n    CHECK ([Quantity]>(0)),\n    CHECK ([UnitPrice]>=(0)),\n\tFOREIGN KEY ([OrderID]) REFERENCES [Orders] ([OrderID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ProductID]) REFERENCES [Products] ([ProductID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Orders](\n   [OrderID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CustomerID]TEXT,\n   [EmployeeID]INTEGER,\n   [OrderDate]DATETIME,\n   [RequiredDate]DATETIME,\n   [ShippedDate]DATETIME,\n   [ShipVia]INTEGER,\n   [Freight]NUMERIC DEFAULT 0,\n   [ShipName]TEXT,\n   [ShipAddress]TEXT,\n   [ShipCity]TEXT,\n   [ShipRegion]TEXT,\n   [ShipPostalCode]TEXT,\n   [ShipCountry]TEXT,\n   FOREIGN KEY ([EmployeeID]) REFERENCES [Employees] ([EmployeeID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([CustomerID]) REFERENCES [Customers] ([CustomerID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ShipVia]) REFERENCES [Shippers] ([ShipperID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Products](\n   [ProductID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [ProductName]TEXT NOT NULL,\n   [SupplierID]INTEGER,\n   [CategoryID]INTEGER,\n   [QuantityPerUnit]TEXT,\n   [UnitPrice]NUMERIC DEFAULT 0,\n   [UnitsInStock]INTEGER DEFAULT 0,\n   [UnitsOnOrder]INTEGER DEFAULT 0,\n   [ReorderLevel]INTEGER DEFAULT 0,\n   [Discontinued]TEXT NOT NULL DEFAULT '0',\n    CHECK ([UnitPrice]>=(0)),\n    CHECK ([ReorderLevel]>=(0)),\n    CHECK ([UnitsInStock]>=(0)),\n    CHECK ([UnitsOnOrder]>=(0)),\n\tFOREIGN KEY ([CategoryID]) REFERENCES [Categories] ([CategoryID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([SupplierID]) REFERENCES [Suppliers] ([SupplierID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Suppliers](\n   [SupplierID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CompanyName]TEXT NOT NULL,\n   [ContactName]TEXT,\n   [ContactTitle]TEXT,\n   [Address]TEXT,\n   [City]TEXT,\n   [Region]TEXT,\n   [PostalCode]TEXT,\n   [Country]TEXT,\n   [Phone]TEXT,\n   [Fax]TEXT,\n   [HomePage]TEXT\n)",
        "query": "SELECT SUM(T2.UnitPrice * T2.Quantity * (1 - T2.Discount)) FROM Orders AS T1 INNER JOIN 'Order Details' AS T2 ON T1.OrderID = T2.OrderID INNER JOIN Products AS T3 ON T2.ProductID = T3.ProductID INNER JOIN Categories AS T4 ON T3.CategoryID = T4.CategoryID WHERE T1.OrderDate BETWEEN '1997-06-01' AND '1997-06-30' AND T4.CategoryName = 'Beverages';"
      },
      {
        "question": "Using the AOV definition from the KPI docs, what was the Average Order Value during 'Winter Classics 1997'?",
        "schema": "CREATE TABLE [Categories]\n(      [CategoryID] INTEGER PRIMARY KEY AUTOINCREMENT,\n       [CategoryName] TEXT,\n       [Description] TEXT,\n       [Picture] BLOB\n)\n\nCREATE TABLE [Customers]\n(      [CustomerID] TEXT,\n       [CompanyName] TEXT,\n       [ContactName] TEXT,\n       [ContactTitle] TEXT,\n       [Address] TEXT,\n       [City] TEXT,\n       [Region] TEXT,\n       [PostalCode] TEXT,\n       [Country] TEXT,\n       [Phone] TEXT,\n       [Fax] TEXT,\n       PRIMARY KEY (`CustomerID`)\n)\n\nCREATE TABLE [Order Details](\n   [OrderID]INTEGER NOT NULL,\n   [ProductID]INTEGER NOT NULL,\n   [UnitPrice]NUMERIC NOT NULL DEFAULT 0,\n   [Quantity]INTEGER NOT NULL DEFAULT 1,\n   [Discount]REAL NOT NULL DEFAULT 0,\n    PRIMARY KEY (\"OrderID\",\"ProductID\"),\n    CHECK ([Discount]>=(0) AND [Discount]<=(1)),\n    CHECK ([Quantity]>(0)),\n    CHECK ([UnitPrice]>=(0)),\n\tFOREIGN KEY ([OrderID]) REFERENCES [Orders] ([OrderID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ProductID]) REFERENCES [Products] ([ProductID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Orders](\n   [OrderID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CustomerID]TEXT,\n   [EmployeeID]INTEGER,\n   [OrderDate]DATETIME,\n   [RequiredDate]DATETIME,\n   [ShippedDate]DATETIME,\n   [ShipVia]INTEGER,\n   [Freight]NUMERIC DEFAULT 0,\n   [ShipName]TEXT,\n   [ShipAddress]TEXT,\n   [ShipCity]TEXT,\n   [ShipRegion]TEXT,\n   [ShipPostalCode]TEXT,\n   [ShipCountry]TEXT,\n   FOREIGN KEY ([EmployeeID]) REFERENCES [Employees] ([EmployeeID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([CustomerID]) REFERENCES [Customers] ([CustomerID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([ShipVia]) REFERENCES [Shippers] ([ShipperID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Products](\n   [ProductID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [ProductName]TEXT NOT NULL,\n   [SupplierID]INTEGER,\n   [CategoryID]INTEGER,\n   [QuantityPerUnit]TEXT,\n   [UnitPrice]NUMERIC DEFAULT 0,\n   [UnitsInStock]INTEGER DEFAULT 0,\n   [UnitsOnOrder]INTEGER DEFAULT 0,\n   [ReorderLevel]INTEGER DEFAULT 0,\n   [Discontinued]TEXT NOT NULL DEFAULT '0',\n    CHECK ([UnitPrice]>=(0)),\n    CHECK ([ReorderLevel]>=(0)),\n    CHECK ([UnitsInStock]>=(0)),\n    CHECK ([UnitsOnOrder]>=(0)),\n\tFOREIGN KEY ([CategoryID]) REFERENCES [Categories] ([CategoryID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION,\n\tFOREIGN KEY ([SupplierID]) REFERENCES [Suppliers] ([SupplierID]) \n\t\tON DELETE NO ACTION ON UPDATE NO ACTION\n)\n\nCREATE TABLE [Suppliers](\n   [SupplierID]INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,\n   [CompanyName]TEXT NOT NULL,\n   [ContactName]TEXT,\n   [ContactTitle]TEXT,\n   [Address]TEXT,\n   [City]TEXT,\n   [Region]TEXT,\n   [PostalCode]TEXT,\n   [Country]TEXT,\n   [Phone]TEXT,\n   [Fax]TEXT,\n   [HomePage]TEXT\n)",
        "query": "SELECT CAST(SUM(T2.UnitPrice * T2.Quantity * (1 - T2.Discount)) / COUNT(DISTINCT T1.OrderID) AS REAL) FROM Orders AS T1 INNER JOIN 'Order Details' AS T2 ON T1.OrderID = T2.OrderID WHERE T1.OrderDate BETWEEN '1997-12-01' AND '1997-12-31';"
      }
    ],
    "signature": {
      "instructions": "Convert natural language to *correct and runnable* SQLite query.\n- IMPORTANT: ALWAYS use double quotes around table and column names that contain spaces (e.g., \"Order Details\").\n- Use 'AS T1', 'AS T2', etc. for table aliases.\n- For date comparisons, prefer STRFTIME('%Y-%m-%d', date_column) for full dates, or STRFTIME('%Y', date_column) for years.\n- Ensure the query is valid SQLite syntax. Avoid non-standard SQL keywords (like ILIKE if not supported).",
      "fields": [
        {
          "prefix": "Question:",
          "description": "${question}"
        },
        {
          "prefix": "Schema:",
          "description": "Database schema"
        },
        {
          "prefix": "Reasoning: Let's think step by step in order to",
          "description": "${reasoning}"
        },
        {
          "prefix": "Sql Query:",
          "description": "Valid SQLite query"
        }
      ]
    },
    "lm": null
  },
  "metadata": {
    "dependency_versions": {
      "python": "3.11",
      "dspy": "3.0.4",
      "cloudpickle": "3.1"
    }
  }
}
